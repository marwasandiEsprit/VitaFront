<div class="d-flex align-items-center justify-content-center" style="height: 100vh;">
  <div class="card" style="width: 28rem;">
    <div class="card-body">
      <form *ngIf="!isSignupSuccessful" name="form" (ngSubmit)="f.form.valid && onSubmit()" #f="ngForm" novalidate>
        <div class="mb-3 pass text-center">
          <i class="fas fa-user"></i>
          <input type="text"
                 class="form-control"
                 placeholder="Username..."
                 name="username"
                 [(ngModel)]="form.username"
                 required #username="ngModel">
        </div>

        <div class="mb-3 pass text-center">
          <i class="fas fa-envelope"></i>
          <input type="email"
                 class="form-control"
                 placeholder="Email..."
                 name="email"
                 [(ngModel)]="form.email"
                 required email #email="ngModel">
        </div>

        <div class="mb-3 pass text-center">
          <i class="fas fa-lock"></i>
          <input type="password"
                 placeholder="Password..."
                 class="form-control"
                 name="password"
                 [(ngModel)]="form.password"
                 required minlength="6"
                 #password="ngModel">
        </div>

        <div class="mb-3 pass text-center">
          <i class="fas fa-lock"></i>
          <input type="password"
                 placeholder="Confirm Password..."
                 class="form-control"
                 name="confirmPassword"
                 [(ngModel)]="form.confirmPassword"
                 required minlength="6"
                 #confirmPassword="ngModel">
        </div>
        <div class="mb-3 pass text-center">
          <input
            id="mfaEnabled"
            name="mfaEnabled"
            type="checkbox"
            [(ngModel)]="form.mfaEnabled"
          >
          <label for="mfaEnabled">Enable 2FA</label>
        </div>
        <button
          type="submit"
          class="btn btn-primary mt-4 rounded-pill btlog d-block mx-auto"
        >
          Register
        </button>
        <div class="alert alert-danger" *ngIf="!passwordMatch">Passwords do not match</div>
        <div class="alert alert-danger" *ngIf="isSignUpFailed">Signup failed: {{ errorMessage }} </div>
            <a [routerLink]="['/login']" class="link">Already have an account? Log in</a>
      </form>

      <div class="alert alert-success" *ngIf="isSignupSuccessful">
        Your registration is successful!
      </div>

      <div class="container" *ngIf="response.mfaEnabled && !isVerifySuccessful">
        <h2>Set Up Two-Factor Authentication</h2>
        <div class="qr-code">
          <img [src]="response.secretImageUri" alt="QR Code">
        </div>
        <div class="mb-3 pass text-center">
          <label for="validationCode">Enter 6 digits Validation Code Generated by the app</label>
          <input
            type="text"
            id="validationCode"
            name="validationCode"
            required
            [(ngModel)]="otpCode"
          >
        </div>
        <div class="alert alert-danger" *ngIf="isVerifyFailed">Verification failed</div>
        <button
          type="button"
          class="btn btn-primary mt-4 rounded-pill btlog d-block mx-auto"
          (click)="verifyTfa()"
          [class.button-disabled]="otpCode.length < 6"
        >Verify code</button>
      </div>

      <div class="alert alert-success" *ngIf="isVerifySuccessful">
        Your verification is successful!
      </div>

    </div>
  </div>
</div>
