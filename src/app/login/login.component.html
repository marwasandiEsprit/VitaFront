<div class="d-flex align-items-center justify-content-center" style="height: 100vh;">
  <div class="card" style="width: 28rem;">
    <div class="card-body">
      <form *ngIf="!isLoggedIn" name="form" (ngSubmit)="f.form.valid && onSubmit()" #f="ngForm" novalidate>
        <div class="mb-3 pass text-center">
          <i class="fas fa-user"></i>
          <input type="text"
                 class="form-control"
                 placeholder="Username..."
                 name="username" [(ngModel)]="form.username"
                 required #username="ngModel">
        </div>

        <div class="mb-3 pass text-center">
          <i class="fas fa-lock"></i>
          <input type="password"
                 placeholder="Password..."
                 class="form-control"
                 name="password"
                 [(ngModel)]="form.password"
                 required minlength="6"
                 #password="ngModel">
        </div>
        <a [routerLink]="['/forgetpassword']" class="link">You forget your password? Click here</a>

        <div class="alert alert-danger" *ngIf="isLoginFailed">Signup failed: {{ errorMessage }} 
        <a routerLink="/verify"> Click here to verify your email </a>
        </div>
        <button
          type="submit"
          class="btn btn-primary mt-4 rounded-pill btlog d-block mx-auto"
        >
          Login
        </button>
      </form>
      <div class="container" *ngIf="response.mfaEnabled">
        <h2>Two-Factor Authentication</h2>
        <div class="mb-3 pass text-center">
          <label for="validationCode">Enter 6 digits Validation Code Generated by the app</label>
          <input
            type="text"
            id="validationCode"
            name="validationCode"
            required
            [(ngModel)]="otpCode"
          >
        </div>
        <div class="alert alert-danger" *ngIf="isVerifyFailed">Verification failed</div>
        <button type="button"
                class="btn btn-primary mt-4 rounded-pill btlog d-block mx-auto"
                (click)="verifyTfa()"
                [class.button-disabled]="otpCode.length < 6"
        >Verify code</button>
      </div>

      <div class="alert alert-success" *ngIf="isLoggedIn">
        Logged in as {{ roles }}.
      </div>
    </div>
  </div>
</div>
